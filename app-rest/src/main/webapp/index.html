<!DOCTYPE html>
<html>
    <head>
        <title>Start Page</title>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    </head>
    <body>
        <h1>Test</h1>
        <textarea id="resultado"></textarea>
        <div>
            <button id="btnJson">Factura JSON</button>
            <button id="btnXML">Factura XML</button>
            <button id="btnJsonLista">Lista Facturas JSON</button>
            <button id="btnXMLLista">Lista Facturas XML</button>            
        </div>
        <div>
            <div>
                <span>CLiente</span>
                <input type="text" id="nombreCliente"/>
                <button id="btnCrearFacturaJson">Crear</button>
            </div>
        </div>
        <script>

            function doRequest(url, miInit) {
                fetch(url, miInit)
                        .then(function (response) {
                            return response.text();
                        })
                        .then(function (miBlob) {
                            console.log(miBlob);
                            let miResultado = document.getElementById("resultado");
                            //miResultado.innerHTML = miBlob;
                            miResultado.value = miBlob;
                        });

            }
            ;
//    'Accept': 'application/json, text/plain, */*',

            document.getElementById("btnJson").addEventListener("click", function () {
                var misCabeceras = new Headers();
                misCabeceras.append('Accept','application/json')

                var miInit = {method: 'GET',
                    headers: misCabeceras,
                    mode: 'cors',
                    cache: 'default'};

                doRequest('api/factura/1', miInit);
            });
            document.getElementById("btnJsonLista").addEventListener("click", function () {
                var misCabeceras = new Headers();
                
                var miInit = {method: 'GET',
                    headers: misCabeceras,
                    mode: 'cors',
                    cache: 'default'};

                doRequest('api/factura', miInit);
            });
            document.getElementById("btnCrearFacturaJson").addEventListener("click", function () {
                var misCabeceras = new Headers();
                misCabeceras.append('Content-Type','application/json')

                var datos = {"id":32,"fecha":1513218936195,"cliente":{"id":999,"nombre":"martin","cuit":"20-22333444-5"},"detalle":[{"id":1,"descripcion":"producto 1","precio":760.299767623968,"cantidad":9},{"id":1,"descripcion":"producto 2","precio":774.4656591931198,"cantidad":5},{"id":1,"descripcion":"producto 3","precio":202.73053625428162,"cantidad":1},{"id":1,"descripcion":"producto 4","precio":773.6118079914816,"cantidad":5},{"id":1,"descripcion":"producto 5","precio":573.2888264519227,"cantidad":8},{"id":1,"descripcion":"producto 6","precio":89.58961201362293,"cantidad":5},{"id":1,"descripcion":"producto 7","precio":509.1432810413576,"cantidad":5},{"id":1,"descripcion":"producto 8","precio":104.22903855899845,"cantidad":5},{"id":1,"descripcion":"producto 9","precio":446.48110222859316,"cantidad":7}]};
                datos.cliente.nombre = document.getElementById("nombreCliente").value;
                var miInit = {method: 'POST',
                    headers: misCabeceras,
                    mode: 'cors',
                    body: JSON.stringify(datos),
                    cache: 'default'};

                doRequest('api/factura', miInit);
            });



        </script>
    </body>
</html>
